<script type="module">
  import { auth, db } from "./firebase.js";
  import { doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
  import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

  onAuthStateChanged(auth, (user) => {
    if (!user) {
      window.location.href = "login.html";
    }
  });

  const form = document.getElementById("professorForm");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const user = auth.currentUser;
    if (!user) {
      alert("You must be logged in");
      return;
    }

    await setDoc(doc(db, "professors", user.uid), {
      name: document.getElementById("name").value.toLowerCase(),
      department: document.getElementById("department").value,
      publications: document.getElementById("publications").value,
      researchPapers: document.getElementById("researchPapers").value,
      experience: document.getElementById("experience").value,
      education: document.getElementById("education").value,
      email: user.email
    });

    alert("Profile saved");
    window.location.href = "dashboard.html";
  });
</script>
